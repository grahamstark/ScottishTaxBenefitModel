<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Weighting · ScottishTaxBenefitModel.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://grahamstark.github.io/ScottishTaxBenefitModel.jl/weighting/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">ScottishTaxBenefitModel.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../module_listing/">Module Listing</a></li><li class="is-active"><a class="tocitem" href>Weighting</a><ul class="internal"><li><a class="tocitem" href="#TODO"><span>TODO</span></a></li><li><a class="tocitem" href="#Sources"><span>Sources</span></a></li></ul></li><li><a class="tocitem" href="../annotated_bibliography/">Annotated Bibliography</a></li><li><a class="tocitem" href="../test_suite/">Test Suite</a></li><li><a class="tocitem" href="../validation_in_aggregate/">Validation in Aggregate</a></li><li><a class="tocitem" href="../coding_notes/">Coding Notes</a></li><li><a class="tocitem" href="../TODO/">TODO</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Weighting</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Weighting</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/grahamstark/ScottishTaxBenefitModel.jl/blob/master/docs/src/weighting.md#L" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Notes-on-weighting"><a class="docs-heading-anchor" href="#Notes-on-weighting">Notes on weighting</a><a id="Notes-on-weighting-1"></a><a class="docs-heading-anchor-permalink" href="#Notes-on-weighting" title="Permalink"></a></h1><p>Code: <a href="/src/Weighting.jl">Weighting.jl</a>. Uses <a href="https://github.com/grahamstark/SurveyDataWeighting.jl">Julia weighting code</a>. </p><p>For the general ideas, see (e.g.):</p><ul><li>Creedy, John. “Survey Reweighting for Tax Microsimulation Modelling.” Treasury Working Paper Series. New Zealand Treasury, September 2003. http://ideas.repec.org/p/nzt/nztwps/03-17.html.</li><li>Creedy, John, and Ivan Tuckwell. “Reweighting the New Zealand Household Economic Survey for Tax Microsimulation Modelling.” Treasury Working Paper Series. New Zealand Treasury, December 2003. https://ideas.repec.org/p/nzt/nztwps/03-33.html.</li><li>Merz, Joachim. ‘Microdata Adjustment by the Minimum Information Loss Principle’. SSRN Scholarly Paper. Rochester, NY: Social Science Research Network, 1 July 1994. https://papers.ssrn.com/abstract=1417310.</li></ul><p>Our weighting is intended to create weights at run-time for whatever set of households is fed to it. </p><p>For the current case, the Scottish subset is 4 years of FRS data for 2015-2018; 11,048 households. Given 2,477,000 households (see below for this figure), this gives an average weight of 224.2. If we scale the FRS population by this, we get:</p><table><tr><th style="text-align: right">Item</th><th style="text-align: right">id</th><th style="text-align: right">population target</th><th style="text-align: right">unweighted total</th><th style="text-align: right">%diff</th></tr><tr><td style="text-align: right">M- Total in employment- aged 16+</td><td style="text-align: right">1</td><td style="text-align: right">1,358,545</td><td style="text-align: right">1,147,698</td><td style="text-align: right">-16%</td></tr><tr><td style="text-align: right">M- Total unemployed- aged 16+</td><td style="text-align: right">2</td><td style="text-align: right">61,446</td><td style="text-align: right">55,827</td><td style="text-align: right">-9%</td></tr><tr><td style="text-align: right">F- Total in employment- aged 16+</td><td style="text-align: right">3</td><td style="text-align: right">1,318,657</td><td style="text-align: right">1,138,057</td><td style="text-align: right">-14%</td></tr><tr><td style="text-align: right">F- Total unemployed- aged 16+</td><td style="text-align: right">4</td><td style="text-align: right">60,095</td><td style="text-align: right">38,339</td><td style="text-align: right">-36%</td></tr><tr><td style="text-align: right">private rented</td><td style="text-align: right">5</td><td style="text-align: right">365,878</td><td style="text-align: right">314,782</td><td style="text-align: right">-14%</td></tr><tr><td style="text-align: right">housing association</td><td style="text-align: right">6</td><td style="text-align: right">278,956</td><td style="text-align: right">229,360</td><td style="text-align: right">-18%</td></tr><tr><td style="text-align: right">las, etc rented</td><td style="text-align: right">7</td><td style="text-align: right">310,508</td><td style="text-align: right">355,811</td><td style="text-align: right">15%</td></tr><tr><td style="text-align: right">M- 0 - 4</td><td style="text-align: right">8</td><td style="text-align: right">139,982</td><td style="text-align: right">150,441</td><td style="text-align: right">7%</td></tr><tr><td style="text-align: right">M- 5 - 9</td><td style="text-align: right">9</td><td style="text-align: right">153,297</td><td style="text-align: right">149,992</td><td style="text-align: right">-2%</td></tr><tr><td style="text-align: right">M- 0 – 4</td><td style="text-align: right">10</td><td style="text-align: right">150,487</td><td style="text-align: right">141,024</td><td style="text-align: right">-6%</td></tr><tr><td style="text-align: right">M- 15 - 19</td><td style="text-align: right">11</td><td style="text-align: right">144,172</td><td style="text-align: right">113,671</td><td style="text-align: right">-21%</td></tr><tr><td style="text-align: right">M- 20 - 24</td><td style="text-align: right">12</td><td style="text-align: right">176,066</td><td style="text-align: right">107,842</td><td style="text-align: right">-39%</td></tr><tr><td style="text-align: right">M- 25 - 29</td><td style="text-align: right">13</td><td style="text-align: right">191,145</td><td style="text-align: right">119,725</td><td style="text-align: right">-37%</td></tr><tr><td style="text-align: right">M- 30 - 34</td><td style="text-align: right">14</td><td style="text-align: right">182,635</td><td style="text-align: right">131,383</td><td style="text-align: right">-28%</td></tr><tr><td style="text-align: right">M- 35 - 39</td><td style="text-align: right">15</td><td style="text-align: right">172,624</td><td style="text-align: right">147,750</td><td style="text-align: right">-14%</td></tr><tr><td style="text-align: right">M- 40 - 44</td><td style="text-align: right">16</td><td style="text-align: right">156,790</td><td style="text-align: right">145,508</td><td style="text-align: right">-7%</td></tr><tr><td style="text-align: right">M- 45 - 49</td><td style="text-align: right">17</td><td style="text-align: right">174,812</td><td style="text-align: right">166,359</td><td style="text-align: right">-5%</td></tr><tr><td style="text-align: right">M- 50 - 54</td><td style="text-align: right">18</td><td style="text-align: right">193,940</td><td style="text-align: right">176,897</td><td style="text-align: right">-9%</td></tr><tr><td style="text-align: right">M- 55 - 59</td><td style="text-align: right">19</td><td style="text-align: right">190,775</td><td style="text-align: right">178,690</td><td style="text-align: right">-6%</td></tr><tr><td style="text-align: right">M- 60 - 64</td><td style="text-align: right">20</td><td style="text-align: right">166,852</td><td style="text-align: right">182,726</td><td style="text-align: right">10%</td></tr><tr><td style="text-align: right">M- 65 - 69</td><td style="text-align: right">21</td><td style="text-align: right">144,460</td><td style="text-align: right">195,057</td><td style="text-align: right">35%</td></tr><tr><td style="text-align: right">M- 70 - 74</td><td style="text-align: right">22</td><td style="text-align: right">132,339</td><td style="text-align: right">152,683</td><td style="text-align: right">15%</td></tr><tr><td style="text-align: right">M- 75 - 79</td><td style="text-align: right">23</td><td style="text-align: right">87,886</td><td style="text-align: right">113,671</td><td style="text-align: right">29%</td></tr><tr><td style="text-align: right">M- 80’+</td><td style="text-align: right">24</td><td style="text-align: right">104,741</td><td style="text-align: right">112,550</td><td style="text-align: right">7%</td></tr><tr><td style="text-align: right">F- 0 - 4</td><td style="text-align: right">25</td><td style="text-align: right">131,733</td><td style="text-align: right">149,095</td><td style="text-align: right">13%</td></tr><tr><td style="text-align: right">F- 5 - 9</td><td style="text-align: right">26</td><td style="text-align: right">146,019</td><td style="text-align: right">149,320</td><td style="text-align: right">2%</td></tr><tr><td style="text-align: right">F- 10 - 14</td><td style="text-align: right">27</td><td style="text-align: right">144,187</td><td style="text-align: right">130,486</td><td style="text-align: right">-10%</td></tr><tr><td style="text-align: right">F- 15 - 19</td><td style="text-align: right">28</td><td style="text-align: right">137,786</td><td style="text-align: right">116,137</td><td style="text-align: right">-16%</td></tr><tr><td style="text-align: right">F- 20 - 24</td><td style="text-align: right">29</td><td style="text-align: right">171,390</td><td style="text-align: right">119,052</td><td style="text-align: right">-31%</td></tr><tr><td style="text-align: right">F- 25 - 29</td><td style="text-align: right">30</td><td style="text-align: right">191,110</td><td style="text-align: right">155,597</td><td style="text-align: right">-19%</td></tr><tr><td style="text-align: right">F- 30 - 34</td><td style="text-align: right">31</td><td style="text-align: right">186,828</td><td style="text-align: right">158,960</td><td style="text-align: right">-15%</td></tr><tr><td style="text-align: right">F- 35 - 39</td><td style="text-align: right">32</td><td style="text-align: right">179,898</td><td style="text-align: right">165,686</td><td style="text-align: right">-8%</td></tr><tr><td style="text-align: right">F- 40 - 44</td><td style="text-align: right">33</td><td style="text-align: right">162,642</td><td style="text-align: right">157,167</td><td style="text-align: right">-3%</td></tr><tr><td style="text-align: right">F- 45 - 49</td><td style="text-align: right">34</td><td style="text-align: right">186,646</td><td style="text-align: right">170,843</td><td style="text-align: right">-8%</td></tr><tr><td style="text-align: right">F- 50 - 54</td><td style="text-align: right">35</td><td style="text-align: right">207,150</td><td style="text-align: right">189,004</td><td style="text-align: right">-9%</td></tr><tr><td style="text-align: right">F- 55 - 59</td><td style="text-align: right">36</td><td style="text-align: right">202,348</td><td style="text-align: right">206,716</td><td style="text-align: right">2%</td></tr><tr><td style="text-align: right">F- 60 - 64</td><td style="text-align: right">37</td><td style="text-align: right">177,841</td><td style="text-align: right">196,626</td><td style="text-align: right">11%</td></tr><tr><td style="text-align: right">F- 65 - 69</td><td style="text-align: right">38</td><td style="text-align: right">154,984</td><td style="text-align: right">206,491</td><td style="text-align: right">33%</td></tr><tr><td style="text-align: right">F- 70 - 74</td><td style="text-align: right">39</td><td style="text-align: right">146,517</td><td style="text-align: right">173,085</td><td style="text-align: right">18%</td></tr><tr><td style="text-align: right">F- 75 - 79</td><td style="text-align: right">40</td><td style="text-align: right">108,065</td><td style="text-align: right">120,173</td><td style="text-align: right">11%</td></tr><tr><td style="text-align: right">F- 80+</td><td style="text-align: right">41</td><td style="text-align: right">165,153</td><td style="text-align: right">137,661</td><td style="text-align: right">-17%</td></tr><tr><td style="text-align: right">1 adult: male</td><td style="text-align: right">42</td><td style="text-align: right">439,000</td><td style="text-align: right">391,011</td><td style="text-align: right">-11%</td></tr><tr><td style="text-align: right">1 adult: female</td><td style="text-align: right">43</td><td style="text-align: right">467,000</td><td style="text-align: right">482,262</td><td style="text-align: right">3%</td></tr><tr><td style="text-align: right">2 adults</td><td style="text-align: right">44</td><td style="text-align: right">797,000</td><td style="text-align: right">895,693</td><td style="text-align: right">12%</td></tr><tr><td style="text-align: right">1 adult, 1 child</td><td style="text-align: right">45</td><td style="text-align: right">70,000</td><td style="text-align: right">65,467</td><td style="text-align: right">-6%</td></tr><tr><td style="text-align: right">1 adult, 2+ children</td><td style="text-align: right">46</td><td style="text-align: right">66,000</td><td style="text-align: right">47,755</td><td style="text-align: right">-28%</td></tr><tr><td style="text-align: right">2+ adults, 1+ children</td><td style="text-align: right">47</td><td style="text-align: right">448,000</td><td style="text-align: right">431,367</td><td style="text-align: right">-4%</td></tr><tr><td style="text-align: right">3+ adults</td><td style="text-align: right">48</td><td style="text-align: right">190,000</td><td style="text-align: right">163,444</td><td style="text-align: right">-14%</td></tr><tr><td style="text-align: right">Carer’s Allowance</td><td style="text-align: right">49</td><td style="text-align: right">77,842</td><td style="text-align: right">64,571</td><td style="text-align: right">-17%</td></tr><tr><td style="text-align: right">Attendance Allowance</td><td style="text-align: right">50</td><td style="text-align: right">127,307</td><td style="text-align: right">82,731</td><td style="text-align: right">-35%</td></tr><tr><td style="text-align: right">PIP/DLA</td><td style="text-align: right">51</td><td style="text-align: right">431,461</td><td style="text-align: right">330,476</td><td style="text-align: right">-23%</td></tr></table><p>So, overstating most elderly, understating the sick, young people, households with children.</p><h2 id="TODO"><a class="docs-heading-anchor" href="#TODO">TODO</a><a id="TODO-1"></a><a class="docs-heading-anchor-permalink" href="#TODO" title="Permalink"></a></h2><p>We really need some sort of incomes weight other than employment. E.g. higher rate payers, income tax payers.</p><h2 id="Sources"><a class="docs-heading-anchor" href="#Sources">Sources</a><a id="Sources-1"></a><a class="docs-heading-anchor-permalink" href="#Sources" title="Permalink"></a></h2><p>Sources for the targets are as follows. Note that they presently don&#39;t always represent the same date (some 2018, some 2020). All numbers presently used are pre-covid lockdowns.</p><ul><li>Households: <a href="https://www.nrscotland.gov.uk/statistics-and-data/statistics/statistics-by-theme/households/household-estimates/2019">NRS: Estimates of Households and Dwellings in Scotland, 2019</a> file house-est-19-all-tabs.xlsx table 7</li><li>Tenure: <a href="https://www.gov.scot/publications/housing-statistics-stock-by-tenure/">Scottish Government: Housing statistics: Stock by tenure</a> file strock.xls data for March 2018</li><li>Employment: <a href="https://www.nomisweb.co.uk/">Nomis</a>; file 291203550.csv</li><li>benefits <a href="https://stat-xplore.dwp.gov.uk/">DWP: StatExplore</a> files table_2020-07-17(XX).xslx</li><li>population <a href="https://www.nrscotland.gov.uk/statistics-and-data/statistics/statistics-by-theme/population/population-estimates/mid-year-population-estimates">NRS: Mid-Year Population Estimates</a> file mid-year-pop-est-19-data.xlsxmid-year-pop-est-19-data.xlsx table 1</li></ul><p>All raw data retrieved 16-17 July 2020, and stored in <a href="/data/targets/">/data/targets/</a>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../module_listing/">« Module Listing</a><a class="docs-footer-nextpage" href="../annotated_bibliography/">Annotated Bibliography »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Thursday 17 November 2022 19:13">Thursday 17 November 2022</span>. Using Julia version 1.8.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
